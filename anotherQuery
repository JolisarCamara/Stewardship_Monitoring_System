-- 1️⃣ Create referenced table first
CREATE TABLE admins_role (
  placement_id SERIAL PRIMARY KEY,
  coordinator_placement VARCHAR(100) NOT NULL,
  description TEXT
);

-- 2️⃣ Then scholar profiles
CREATE TABLE scholar_profiles (
  user_id INT PRIMARY KEY REFERENCES users(id) ON DELETE CASCADE,
  placement_id INT REFERENCES admins_role(placement_id),
  student_id VARCHAR(50) NOT NULL,
  course VARCHAR(100),
  year_level VARCHAR(20), 
  designation VARCHAR(100), 
  committed_day VARCHAR(50),
  committed_time VARCHAR(100), 
  required_stewardship_hours INT, 
  counterpart DECIMAL(10, 2), 
  coordinator VARCHAR(255)
);

-- 3️⃣ Then admin profiles
CREATE TABLE admin_profiles (
  user_id INT PRIMARY KEY REFERENCES users(id) ON DELETE CASCADE,
  placement_id INT REFERENCES admins_role(placement_id)
);


--JOINS
SELECT 
        u.id, 
        u.name, 
        u.email, 
        r.name AS role_name,
        ar.coordinator_placement,
        ar.description AS placement_description,
        u.created_at
      FROM users u
      JOIN roles r ON u.role_id = r.id
      JOIN admin_profiles ap ON u.id = ap.user_id
      JOIN admins_role ar ON ap.placement_id = ar.placement_id
      WHERE r.name = 'admin' OR r.name = 'super-admin'
      ORDER BY u.created_at DESC